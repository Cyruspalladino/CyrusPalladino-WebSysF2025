<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Starry Night — Art Institute API demo</title>
  <style>
    body { font-family: system-ui, Arial; padding: 1.2rem; max-width: 900px; margin: auto; }
    img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 6px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    .meta { margin-top: .5rem; color: #333; }
    .notice { background:#fff3cd; padding:.6rem; border-radius:6px; margin-top:1rem; border:1px solid #f0c36d; }
  </style>
</head>
<body>
  <h1>Search Art Institute of Chicago for "Starry Night"</h1>
  <p>This demo searches the AIC public API for artworks with the query <code>Starry Night</code> and shows the first image it finds (if any).</p>

  <div id="result">
    <p>Searching the Art Institute of Chicago API…</p>
  </div>

  <script>
    async function showStarryNightFromAIC() {
      const resultEl = document.getElementById('result');

      try {
        // Query the Art Institute search endpoint for "Starry Night"
        const q = encodeURIComponent('Starry Night');
        const fields = encodeURIComponent('id,title,image_id,artist_display,date_display');
        const url = `https://api.artic.edu/api/v1/artworks/search?q=${q}&fields=${fields}&limit=5`;

        const res = await fetch(url);
        if (!res.ok) throw new Error('AIC API request failed: ' + res.status);

        const j = await res.json();

        // If the API returns results, construct IIIF image URL and show the first one
        if (Array.isArray(j.data) && j.data.length > 0) {
          // prefer the first item that has an image_id
          const found = j.data.find(item => item.image_id);
          if (found) {
            // config.iiif_url normally exists on list/detail endpoints; fallback to recommended base
            const iiifBase = (j.config && j.config.iiif_url) ? j.config.iiif_url : 'https://www.artic.edu/iiif/2';
            const imgId = found.image_id;
            // recommended size pattern from the AIC docs:
            const imgUrl = `${iiifBase}/${imgId}/full/843,/0/default.jpg`;

            resultEl.innerHTML = `
              <h2>${escapeHtml(found.title)}</h2>
              <p class="meta"><strong>Artist:</strong> ${escapeHtml(found.artist_display || '—')} · <strong>Date:</strong> ${escapeHtml(found.date_display || '—')}</p>
              <img id="aic-img" src="${imgUrl}" alt="${escapeHtml(found.title)}" />
              <p class="meta">Image delivered via Art Institute of Chicago IIIF endpoint.</p>
            `;
            return;
          }
        }

        // No matching image found in AIC collection
        resultEl.innerHTML = `
          <div class="notice">
            <strong>No "Starry Night" image found in the Art Institute of Chicago collection.</strong>
            <p>The famous Van Gogh “The Starry Night” is in MoMA (Museum of Modern Art) in New York, so it won't be returned by the Art Institute API.</p>
            <p>If you still want to display Van Gogh's Starry Night you can set a fallback image URL below (e.g. a public domain copy from Wikimedia or an image served by MoMA if allowed).</p>
          </div>
          <p style="margin-top:.8rem;"><em>Example fallback area (edit to supply your own image URL):</em></p>
          <img id="fallback" alt="Fallback image placeholder" />
        `;

        // Example fallback — you can replace this URL with a public-domain image URL you trust
        const fallbackImg = document.getElementById('fallback');
        // ✳️ Replace the value of fallbackUrl with the direct image URL you want to show.
        const fallbackUrl = ''; // <-- put a direct image URL here (e.g. Wikimedia Commons)
        if (fallbackUrl) fallbackImg.src = fallbackUrl;
        else fallbackImg.style.display = 'none';

      } catch (err) {
        resultEl.innerHTML = `<p style="color:crimson">Error: ${escapeHtml(err.message)}</p>`;
        console.error(err);
      }
    }

    function escapeHtml(s) {
      return String(s || '').replace(/[&<>"']/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[ch]));
    }

    showStarryNightFromAIC();
  </script>
</body>
</html>
